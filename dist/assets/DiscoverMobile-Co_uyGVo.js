import{j as e,u as t,g as n,s as i,p as s}from"./index-o4lGSIZO.js";import{b as r,a as o,r as a}from"./vendor-react-CyvzqkFf.js";import{c as l,I as c}from"./createLucideIcon-D_xG-gSw.js";import{H as u,A as d,S as h}from"./share-2-Sf0lRmA8.js";import{S as m,a as g}from"./settings-DkAwU-7b.js";import{u as p,b as f,c as b}from"./router-CSFsjDW6.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=l("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),v=l("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),x=l("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),w=l("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),k=l("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),N=l("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),j=l("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),C=l("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),S=l("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),I=l("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),E=l("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function A({open:t,onClose:n,onInstall:i,onEnable:s,onLogin:r,canInstall:o=!1,canEnable:a=!1,isIOS:l=!1,isAuthenticated:c=!1}){return t?c?e.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:n,children:e.jsxs("div",{className:"modal-card",onClick:e=>e.stopPropagation(),children:[e.jsx("h3",{className:"modal-title",children:"Enable notifications"}),e.jsx("p",{className:"modal-sub",children:l?e.jsx("span",{children:"Add this app to your Home Screen to receive notifications."}):e.jsx("span",{children:"Install the app to receive notifications."})}),e.jsxs("div",{className:"modal-actions",children:[o&&e.jsx("button",{className:"modal-btn",onClick:i,children:"Add to Home Screen"}),e.jsx("button",{className:"modal-btn modal-btn--primary",onClick:s,disabled:!a,children:"Enable notifications"}),e.jsx("button",{className:"modal-btn modal-btn--ghost",onClick:n,children:"Close"})]})]})}):e.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:n,children:e.jsxs("div",{className:"modal-card",onClick:e=>e.stopPropagation(),children:[e.jsx("h3",{className:"modal-title",children:"Login Required"}),e.jsx("p",{className:"modal-sub",children:e.jsx("span",{children:"Please login with your Google account to continue."})}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{id:"btnLogin",className:"modal-btn modal-btn--primary",onClick:r,children:"Login with Google"}),e.jsx("button",{className:"modal-btn modal-btn--ghost",onClick:n,children:"Close"})]})]})}):null}function T({open:t=!1,onClose:n,onToggleSections:i,onOpenFavorites:s,onToggleTheme:a,onResetCookies:l,onNotifications:c,notificationsEnabled:d=!1,theme:h="light",isFavorites:m=!1}){const[g,p]=r.useState(!1);if(r.useEffect(()=>(p(!0),()=>p(!1)),[]),r.useEffect(()=>{if(!t||!g)return;const e=e=>{"Escape"===e.key&&(null==n||n())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,n,g]),r.useEffect(()=>{if(!t||!g)return;let e="";try{e=document.body.style.overflow,document.body.style.overflow="hidden"}catch{}return()=>{try{document.body.style.overflow=e}catch{}}},[t,g]),!t||!g)return null;const f=[{id:"sections",title:"Manage sections",description:"Choose which sections appear in your feed.",icon:e.jsx(k,{size:18}),action:()=>null==i?void 0:i()},{id:"favorites",title:m?"Back to feed":"Open favorites",description:m?"Return to the main feed view.":"Jump straight to your saved stories.",icon:m?e.jsx(N,{size:18}):e.jsx(u,{size:18}),action:()=>null==s?void 0:s()},{id:"notifications",title:d?"Notifications enabled":"Turn on notifications",description:d?"Send a test notification or manage push settings.":"Enable push alerts for top stories.",icon:d?e.jsx(v,{size:18}):e.jsx(y,{size:18}),action:()=>null==c?void 0:c()},{id:"appearance",title:"Appearance",description:"dark"===h?"Switch to light theme.":"Switch to dark theme.",icon:"dark"===h?e.jsx(I,{size:18}):e.jsx(C,{size:18}),action:()=>null==a?void 0:a()},{id:"reset",title:"Reset cookies",description:"Clear saved preferences and refresh your device ID.",icon:e.jsx(S,{size:18}),action:()=>null==l?void 0:l()}],b=()=>{null==n||n()},x=e.jsx("div",{className:"settings-overlay",role:"dialog","aria-modal":"true","aria-label":"Settings",onClick:b,children:e.jsxs("div",{className:"settings-sheet",onClick:e=>e.stopPropagation(),children:[e.jsxs("header",{className:"settings-header",children:[e.jsx("h2",{children:"Settings"}),e.jsx("button",{className:"icon-btn","aria-label":"Close settings",onClick:b,children:e.jsx(E,{size:18})})]}),e.jsx("ul",{className:"settings-list",children:f.map(t=>e.jsx("li",{children:e.jsxs("button",{className:"settings-option",onClick:()=>(e=>{try{null==e||e()}finally{b()}})(t.action),children:[e.jsx("span",{className:"option-icon",children:t.icon}),e.jsxs("span",{className:"option-copy",children:[e.jsx("span",{className:"option-title",children:t.title}),e.jsx("span",{className:"option-description",children:t.description})]})]})},t.id))})]})});return o.createPortal(x,document.body)}function M(e="/space-shuttle.png"){try{return new URL(e,window.location.origin).toString()}catch{return e}}function $(){try{const e=new URLSearchParams,t="293860278705-ol1bdmtlhm426caa5fr7f8b5q9uba643.apps.googleusercontent.com",n="https://newui.resnet.in/auth/callback",i="openid email profile";e.set("client_id",t),e.set("redirect_uri",n),e.set("response_type","code"),e.set("scope",i),e.set("include_granted_scopes","true"),e.set("prompt","select_account");const s=`https://accounts.google.com/o/oauth2/v2/auth?${e.toString()}`;window.location.assign(s)}catch{}}function L(e,t=512){try{if(!e)return null;const n=new URL(e);return"http:"===n.protocol||"https:"===n.protocol?`/img?u=${encodeURIComponent(e)}&w=${t}`:e}catch{return e}}function z(){try{const e=navigator.userAgent||"";return/iPad|iPhone|iPod/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1}catch{return!1}}function R({title:o,onResetFeed:a,onOpenSearch:l,onToggleSections:c,onOpenFavorites:u,isFavorites:h=!1,topItem:p=null}){const{theme:f,toggle:b}=t(),[y,v]=r.useState(!1),[x,w]=r.useState(!1),[k,N]=r.useState(null),[C,I]=r.useState(!1),[E,R]=r.useState(""),F=r.useRef(null),[P,D]=r.useState(""),[O,B]=r.useState(!1),[q,U]=r.useState(!1),[H,_]=r.useState("");r.useEffect(()=>{F.current=n();try{"1"===localStorage.getItem("notificationsEnabled")&&w(!0)}catch{}let e=!1;try{const t=performance.getEntriesByType&&performance.getEntriesByType("navigation");t&&t[0]&&"reload"===t[0].type&&(e=!0)}catch{}try{"ok"===new URLSearchParams(window.location.search).get("auth")&&(e=!0)}catch{}(async()=>{try{const t=await fetch("/api/user/me",{credentials:"same-origin",cache:"no-store"});if(t.ok){const n=await t.json().catch(()=>null);if(n&&n.ok&&n.user&&(n.user.email||n.user.name)){U(!0);const t=n.user.name?String(n.user.name):"";t&&(D(t),e&&(B(!0),setTimeout(()=>B(!1),5e3))),n.user&&n.user.picture&&_(String(n.user.picture))}else U(!1)}else U(!1)}catch{U(!1)}})()},[]),r.useEffect(()=>{function e(e){e.preventDefault(),N(e)}return window.addEventListener("beforeinstallprompt",e),()=>window.removeEventListener("beforeinstallprompt",e)},[]),r.useEffect(()=>{(async()=>{try{x&&"undefined"!=typeof Notification&&"granted"===Notification.permission&&(W("/api/notifications/enable",{uid:F.current}),await i())}catch{}})()},[x]);const J=()=>v(!1);async function W(e,t){try{await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch{}}async function G(){try{if(!("serviceWorker"in navigator))return!1;if("granted"!==Notification.permission)return!1;const e=await navigator.serviceWorker.ready,t=(null==p?void 0:p.title)||"Update",n=M("/space-shuttle.png");return await e.showNotification("resnet News",{body:t,icon:n,badge:n}),!0}catch{return!1}}const Y=e=>{try{R(e),setTimeout(()=>R(""),1500)}catch{}},Z=async()=>{try{const e=(null==p?void 0:p.title)||"Update";await s(F.current,{title:"resnet News",body:e,icon:M("/space-shuttle.png")})}catch{}},V=()=>{$()};return e.jsxs("header",{className:"m-header",children:[e.jsx("button",{className:"icon-btn","aria-label":"Back",children:e.jsx(d,{size:18})}),e.jsx("h1",{children:O&&P?P.slice(0,12):o}),e.jsxs("div",{className:"actions",children:[q?e.jsx("div",{className:"avatar icon-btn","aria-label":"User avatar",style:H?{backgroundImage:`url(${L(H,64)})`}:void 0}):e.jsx("button",{className:"icon-btn pulse-login","aria-label":"Login",onClick:V,children:e.jsx(j,{size:18})}),e.jsx("button",{className:"icon-btn","aria-label":"Search",onClick:()=>{J(),null==l||l()},children:e.jsx(m,{size:18})}),e.jsx("button",{className:"icon-btn","aria-label":"Restart feed",onClick:()=>{J(),null==a||a()},children:e.jsx(S,{size:18})}),e.jsx("div",{className:"settings-wrap",children:e.jsx("button",{className:"icon-btn","aria-haspopup":"dialog","aria-expanded":y,"aria-label":"Settings",onClick:()=>v(e=>!e),children:e.jsx(g,{size:18})})})]}),E&&e.jsx("div",{className:"toast",role:"status","aria-live":"polite",children:E}),e.jsx(T,{open:y,onClose:J,onToggleSections:()=>{null==c||c()},onOpenFavorites:()=>{null==u||u()},onToggleTheme:()=>{b()},onResetCookies:()=>{!function(){try{const e=(document.cookie||"").split(";");for(const n of e){const e=(n.split("=")[0]||"").trim();e&&(document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`)}const t="u_"+Math.random().toString(36).slice(2)+Date.now().toString(36);try{localStorage.setItem("uid",t)}catch{}document.cookie=`uid=${t}; path=/; max-age=604800`,F.current=t,Y("Cookies reset")}catch{}}()},onNotifications:async()=>{if(J(),!q)return void $();if(!x)return void I(!0);await i(),await Z();const e=await G();z()&&!e&&Y("Notification scheduled. Check when app is backgrounded."),W("/api/notifications/sample",{uid:F.current,top:p})},notificationsEnabled:x,theme:f,isFavorites:h}),e.jsx(A,{open:C,onClose:()=>I(!1),onInstall:async()=>{try{if(!k)return;await k.prompt(),await k.userChoice,N(null)}catch{}},onEnable:async()=>{if(await async function(){try{if(!("Notification"in window))return;let e=Notification.permission;if("default"===e&&(e=await Notification.requestPermission()),"granted"===e){w(!0);try{localStorage.setItem("notificationsEnabled","1")}catch{}return W("/api/notifications/enable",{uid:F.current}),await i(),!0}w(!1);try{localStorage.removeItem("notificationsEnabled")}catch{}return!1}catch{return!1}}()){I(!1),await i(),await Z();const e=await G();z()&&!e&&Y("Notification scheduled. Check when app is backgrounded.")}},onLogin:V,canInstall:Boolean(k)&&!z()&&!function(){try{return window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone}catch{return!1}}(),canEnable:!0,isIOS:z(),isAuthenticated:q})]})}function F({items:t=[],onClose:n,onSubmit:i,onSelect:s}){const[r,o]=a.useState(""),[l,c]=a.useState([]),[u,d]=a.useState([]),[h,g]=a.useState(!1),[p,f]=a.useState(null),b=a.useRef(null),y=a.useRef(null),v=a.useRef(null);a.useEffect(()=>{var e;try{null==(e=b.current)||e.focus()}catch{}const t=document.body.style.overflow,i=document.body.style.position,s=window.scrollY;document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${s}px`,document.body.style.width="100%";const r=e=>{"Escape"===e.key&&(null==n||n())};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r),document.body.style.overflow=t,document.body.style.position=i,document.body.style.top="",document.body.style.width="",window.scrollTo(0,s)}},[n]);const x=(e="")=>e.toLowerCase().replace(/[\u2026…]+/g,"").replace(/[^a-z0-9]+/g," ").replace(/\s+/g," ").trim(),w=a.useMemo(()=>{const e=Array.isArray(t)?t:[],n=x(r);if(!n)return[];const i=[];for(const t of e){const e=x(t.title||""),s=x(t.description||"");let r=!1,o=1e3;e.startsWith(n)?(r=!0,o=0):e.includes(n)?(r=!0,o=1):s.includes(n)&&(r=!0,o=2),r&&i.push({item:t,score:o})}return i.sort((e,t)=>e.score-t.score||(e.item.title||"").length-(t.item.title||"").length),i.slice(0,20).map(e=>e.item)},[t,r]);return a.useEffect(()=>{const e=r.trim();if(!e)return c([]),d([]),f(null),g(!1),y.current&&(y.current.abort(),y.current=null),void(v.current&&(clearTimeout(v.current),v.current=null));v.current&&clearTimeout(v.current),y.current&&(y.current.abort(),y.current=null),g(!0),f(null);const t=new AbortController;return y.current=t,v.current=setTimeout(async()=>{try{const n=`/api/search?q=${encodeURIComponent(e)}`,i=await fetch(n,{signal:t.signal});if(!i.ok)throw new Error(`Search request failed: ${i.status}`);const s=await i.json();if(t.signal.aborted)return;const r=Array.isArray(null==s?void 0:s.results)?s.results:[],o=(null==s?void 0:s.suggestions)&&"object"==typeof s.suggestions?Object.entries(s.suggestions).sort((e,t)=>Number(t[1]||0)-Number(e[1]||0)).map(([e])=>e):[];c(r),d(o.slice(0,10)),f(null)}catch(n){if(t.signal.aborted)return;console.error("SearchOverlay remote search error:",n),c([]),d([]),f("Unable to load results. Check your connection and try again.")}finally{t.signal.aborted||(g(!1),y.current=null)}},300),()=>{t.abort(),v.current&&(clearTimeout(v.current),v.current=null)}},[r]),a.useEffect(()=>()=>{y.current&&y.current.abort(),v.current&&clearTimeout(v.current)},[]),e.jsx("div",{className:"search-overlay",role:"dialog","aria-label":"Search","aria-modal":"true",onClick:()=>null==n?void 0:n(),children:e.jsxs("div",{className:"search-sheet",onClick:e=>e.stopPropagation(),children:[e.jsxs("form",{className:"search-bar",role:"search",onSubmit:e=>{e.preventDefault(),"function"==typeof i&&i(r)},children:[e.jsx(m,{size:18,className:"search-icon","aria-hidden":"true"}),e.jsx("input",{ref:b,type:"text",placeholder:"Search",value:r,onChange:e=>o(e.target.value),"aria-label":"Search query"}),r&&e.jsx("button",{type:"button",className:"clear-btn","aria-label":"Clear",onClick:()=>o(""),children:e.jsx(E,{size:16})}),e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>null==n?void 0:n(),children:"Cancel"})]}),e.jsxs("div",{className:"search-results",children:[!r&&e.jsx("div",{className:"hint",children:"Type to search…"}),r&&e.jsxs(e.Fragment,{children:[h&&e.jsx("div",{className:"hint",children:"Searching…"}),!h&&p&&e.jsx("div",{className:"hint error",children:p}),!h&&!p&&0===l.length&&0===w.length&&e.jsx("div",{className:"hint",children:"No results"}),!h&&!p&&u.length>0&&e.jsxs("div",{className:"search-suggestions","aria-live":"polite",children:[e.jsx("div",{className:"suggestions-title",children:"Popular searches"}),e.jsx("div",{className:"suggestions-list",children:u.map((t,n)=>e.jsx("button",{type:"button",className:"suggestion-chip",onClick:()=>o(t),style:{animationDelay:.04*n+"s"},children:t},t))})]}),!h&&!p&&l.length>0&&e.jsxs(e.Fragment,{children:[u.length>0&&e.jsx("div",{className:"results-divider"}),e.jsx("ul",{className:"results-list",role:"listbox",children:l.map((t,n)=>{var i;const r=t.id||t.idNumber||t.title||`${t.card||"result"}-${n}`,o=Array.isArray(t.images)&&t.images.length?t.images[0]:t.image||t.image_url||null,a=t.description||t.summary||"",l=t.published||t.published_at||t.date||"",c=t.score||(null==(i=t.detail)?void 0:i.score);return e.jsxs("li",{className:"result-item",role:"option",onClick:()=>null==s?void 0:s({...t,image:o}),style:{animationDelay:.04*u.length+.03*n+"s"},children:[o?e.jsx("img",{src:o,alt:"",className:"result-thumb",loading:"lazy"}):e.jsx("div",{className:"result-thumb placeholder"}),e.jsxs("div",{className:"result-meta",children:[e.jsx("div",{className:"result-title",children:t.title}),a&&e.jsx("div",{className:"result-desc",children:a}),(l||c)&&e.jsxs("div",{className:"result-extra",children:[l&&e.jsx("span",{className:"result-chip","aria-label":"Published",children:l}),c&&e.jsx("span",{className:"result-chip","aria-label":"Score",children:c})]})]})]},r)})})]}),!h&&!p&&0===l.length&&w.length>0&&e.jsx("ul",{className:"results-list",role:"listbox",children:w.map((t,n)=>e.jsxs("li",{className:"result-item",role:"option",onClick:()=>null==s?void 0:s(t),style:{animationDelay:.04*u.length+.03*n+"s"},children:[t.image?e.jsx("img",{src:t.image,alt:"",className:"result-thumb",loading:"lazy"}):e.jsx("div",{className:"result-thumb placeholder"}),e.jsxs("div",{className:"result-meta",children:[e.jsx("div",{className:"result-title",children:t.title}),t.description&&e.jsx("div",{className:"result-desc",children:t.description})]})]},t.id||t.title||n))})]})]})]})})}const P=["Tech & Science","Finance","Arts & Culture","Sports","World","Health","Business"];function D(){const[t,n]=a.useState(P[0]);return e.jsx("div",{className:"chips-scroll",role:"tablist","aria-label":"Categories",children:P.map(i=>e.jsx("button",{className:"chip "+(t===i?"active":""),role:"tab","aria-selected":t===i,onClick:()=>n(i),children:i},i))})}function O({article:n,highlighted:i=!1,onOpen:s,globalIndex:r,hideMeta:o=!1}){const{theme:l}=t(),[d,m]=a.useState(!1),[g,p]=a.useState({top:0,left:0}),[f,b]=a.useState(""),[y,v]=a.useState(!1),k=Boolean((null==n?void 0:n.bgColor)||(null==n?void 0:n.bgColorDark)),N={};k&&(N.background="dark"===l?n.bgColorDark||n.bgColor:n.bgColor||n.bgColorDark,N.border="1px solid var(--border)");const j=Array.isArray(n.favicons)?n.favicons:[];function C(){const e="dark"===l?(null==n?void 0:n.bgColorDark)||(null==n?void 0:n.bgColor):(null==n?void 0:n.bgColor)||(null==n?void 0:n.bgColorDark);return"string"==typeof e&&e?e:null}const S=(()=>{const e=n.description;if(!e)return"";if(e.length>420){const t=e.slice(0,420).trimEnd(),n=e.slice(420).trim();return`${t}… +${n?n.split(/\s+/).filter(Boolean).length:0}`}return e})(),I=e=>{e.stopPropagation();try{const t=e.currentTarget.getBoundingClientRect(),n=240,i=200,s=8;let r=t.bottom+s,o=t.right-n;const a=window.innerWidth-n-s;o>a&&(o=a),o<s&&(o=s),r+i>window.innerHeight-s&&(r=Math.max(s,t.top-i-s)),p({top:r,left:o})}catch{p({top:80,left:20})}m(!0)},E=()=>m(!1),A=async e=>{try{await navigator.clipboard.writeText(e)}catch{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch{}document.body.removeChild(t)}},T=async e=>{e.stopPropagation();const t=(null==n?void 0:n.title)||"Article",i=(null==n?void 0:n.idNumber)?`${window.location.origin}/card${n.idNumber}`:`${window.location.origin}/article/${encodeURIComponent(t)}`;try{await A(`${t}\n${i}`),b("Title and link copied."),setTimeout(()=>b(""),3e3),v(!0),setTimeout(()=>v(!1),2e3);try{navigator.share&&await navigator.share({title:t,text:`${t}`,url:i})}catch{}}catch{}},M=e=>{e.stopPropagation(),"function"==typeof s&&s()},[$,L]=a.useState(!1);a.useEffect(()=>{try{const e=`liked:${(null==n?void 0:n.id)||(null==n?void 0:n.title)||""}`,t=localStorage.getItem(e);L("1"===t)}catch{}},[null==n?void 0:n.id,null==n?void 0:n.title]);const z=e=>{e.stopPropagation(),L(e=>{const t=!e;try{const e=`liked:${(null==n?void 0:n.id)||(null==n?void 0:n.title)||""}`,i=function(){try{return localStorage.getItem("uid")||""}catch{return""}}(),s=function(){try{return sessionStorage.getItem("sid")||""}catch{return""}}(),r={idNumber:(null==n?void 0:n.idNumber)||null,title:(null==n?void 0:n.title)||null,clientTs:(new Date).toISOString()};t?(localStorage.setItem(e,"1"),fetch("/api/user/like",{method:"POST",headers:{"Content-Type":"application/json","x-uid":i,"x-sid":s},body:JSON.stringify(r)}).catch(()=>{})):(localStorage.removeItem(e),fetch("/api/user/unlike",{method:"POST",headers:{"Content-Type":"application/json","x-uid":i,"x-sid":s},body:JSON.stringify(r)}).catch(()=>{})),fetch("/api/analytics/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:t?"like":"unlike",id:(null==n?void 0:n.id)||(null==n?void 0:n.title),ts:Date.now()})}).catch(()=>{})}catch{}return t})};return e.jsxs(e.Fragment,{children:[e.jsxs("article",{className:`feed-card card ${k?"has-color":""} ${i?"highlighted":""}`,style:N,children:[e.jsxs("div",{className:"hero-wrap",children:[e.jsx(c,{src:n.image,alt:"",className:"hero",style:{height:220},width:414,height:220,priority:r<=1,loading:r<=1?"eager":"lazy",fetchpriority:0===r||r<=1?"high":"auto",onClick:M,role:"button",tabIndex:0}),n.publishedAt&&e.jsxs("div",{className:"age-badge","aria-label":"Published age",style:{background:C()||void 0,color:function(e){const t=function(e){try{const t=e.replace("#",""),n=3===t.length?t.split("").map(e=>e+e).join(""):t,i=parseInt(n,16);return{r:i>>16&255,g:i>>8&255,b:255&i}}catch{return null}}(e||"");if(!t)return"#ffffff";const n=e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4);return.2126*n(t.r)+.7152*n(t.g)+.0722*n(t.b)>.6?"#111827":"#ffffff"}(C()||"")},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[e.jsx("path",{d:"M12 8v4l3 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),function(e){try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=Date.now()-t.getTime(),i=Math.max(0,Math.floor(n/1e3)),s=Math.floor(i/60),r=Math.floor(s/60),o=Math.floor(r/24);return o>0?1===o?"1 day ago":`${o} days ago`:r>0?1===r?"1 hour ago":`${r} hours ago`:s>0?1===s?"1 min ago":`${s} mins ago`:"just now"}catch{return""}}(n.publishedAt)]})]}),e.jsxs("div",{className:"content",children:[e.jsx("h3",{onClick:M,role:"button",tabIndex:0,children:n.title}),e.jsx("div",{className:"divider",onClick:M,role:"button",tabIndex:0}),n.description&&e.jsx("p",{className:"description",onClick:M,role:"button",tabIndex:0,children:S}),!o&&e.jsxs("div",{className:"meta",children:[e.jsxs("div",{className:"meta-left",children:[n.idNumber&&e.jsxs("span",{className:"card-number",children:["#",n.idNumber]}),j.length>0&&e.jsx("div",{className:"favicons-row",children:j.slice(0,5).map((t,n)=>{const i=(()=>{try{const e=String(t||"");if(/^https?:\/\//i.test(e)){return`/img?u=${encodeURIComponent(e)}&w=64`}return e}catch{return t}})();return e.jsx("img",{src:i,alt:"",className:"favicon",width:18,height:18,loading:"lazy",decoding:"async"},n)})}),e.jsxs("span",{className:"sources-label",children:[n.sources," sources"]})]}),e.jsx("div",{className:"actions",children:k?e.jsxs(e.Fragment,{children:[e.jsx("button",{"aria-label":"Like",className:"icon-btn icon-btn--ghost "+($?"liked":""),"aria-pressed":$,onClick:z,children:e.jsx(u,{size:18,fill:$?"#ffffff":"none"})}),e.jsx("button",{"aria-label":"Share",className:"icon-btn icon-btn--ghost",onClick:T,children:y?e.jsx(x,{size:18}):e.jsx(h,{size:18})}),e.jsx("button",{"aria-label":"More",className:"icon-btn icon-btn--ghost",onClick:I,children:e.jsx(w,{size:18})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{"aria-label":"Like",className:"icon-btn "+($?"liked":""),"aria-pressed":$,onClick:z,children:e.jsx(u,{size:18,fill:$?"#ffffff":"none"})}),e.jsx("button",{"aria-label":"Share",className:"icon-btn",onClick:T,children:y?e.jsx(x,{size:18}):e.jsx(h,{size:18})}),e.jsx("button",{"aria-label":"More",className:"icon-btn",onClick:I,children:e.jsx(w,{size:18})})]})})]})]})]}),d&&e.jsx("div",{className:"more-menu-overlay",onClick:E,role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"more-menu anchored",style:{top:g.top,left:g.left},onClick:e=>e.stopPropagation(),children:[e.jsx("button",{className:"menu-item",onClick:e=>{e.stopPropagation(),M(e),E()},children:"Open"}),e.jsx("button",{className:"menu-item",onClick:e=>{e.stopPropagation(),z(e),E()},children:$?"Unlike":"Like"}),e.jsx("button",{className:"menu-item",onClick:e=>{e.stopPropagation(),T(e),E()},children:"Share"}),e.jsx("div",{className:"menu-sep"}),e.jsx("button",{className:"menu-item",onClick:e=>{e.stopPropagation(),A((null==n?void 0:n.title)||""),m(!1),b("Title copied"),setTimeout(()=>b(""),3e3)},children:"Copy title"}),e.jsx("button",{className:"menu-item",onClick:e=>{e.stopPropagation();const t=`${(null==n?void 0:n.title)||""}${(null==n?void 0:n.description)?"\n\n"+n.description:""}`;A(t),m(!1),b("Full text copied"),setTimeout(()=>b(""),3e3)},children:"Copy full text"})]})}),f&&e.jsx("div",{className:"copy-toast",role:"status","aria-live":"polite",children:f})]})}function B(e,t=768){if(!e)return null;if(!function(e){try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch{return!1}}(e))return e;return`/img?u=${encodeURIComponent(e)}&w=${t}`}function q(){return e.jsxs("article",{className:"skeleton-card",children:[e.jsx("div",{className:"skeleton-hero"}),e.jsxs("div",{className:"skeleton-body",children:[e.jsx("div",{className:"skeleton-line lg"}),e.jsx("div",{className:"skeleton-line md"}),e.jsx("div",{className:"skeleton-line sm"})]})]})}function U(){const t=p(),i=f(),s=b();let o=function(e){if(!e)return null;const t=String(e).replace(/^[a-zA-Z]+/,""),n=Number(t);return Number.isFinite(n)?n:null}((null==i?void 0:i.idx)||null);if(null==o&&"string"==typeof(null==s?void 0:s.pathname))try{const e=s.pathname.match(/\/(?:card)\/?(\d+)/i);e&&e[1]&&(o=Number(e[1]))}catch{}const l=function(){try{const e=sessionStorage.getItem("feedSnapshot");if(!e)return null;const t=JSON.parse(e);return t&&Array.isArray(t.chunks)?t:null}catch{return null}}(),[c,u]=a.useState(()=>{if(null!=o)return[];const e=(()=>{var e;try{return(null==(e=window.history)?void 0:e.state)||{}}catch{return{}}})();if(l&&Array.isArray(l.chunks)&&l.chunks.length){if(!o&&(null==e?void 0:e.resumeCardId)){const t=Number(e.resumeCardId);if(Number.isFinite(t))return l.chunks}return l.chunks}return[]}),[d,h]=a.useState(0),[m,g]=a.useState(()=>{var e;return null!=o?null:null!=(e=null==l?void 0:l.totalChunks)?e:null}),[y,v]=a.useState(!1),[x,w]=a.useState(!1),[k,N]=a.useState(null),[j,C]=a.useState(o),[S,I]=a.useState(null),E=a.useRef(null),A=a.useRef(null),T=n(),[M,$]=a.useState(null),[L,z]=a.useState(null!=o?o:null),[P,U]=a.useState(null!=o),[H,_]=a.useState(!1),[J,W]=a.useState(!1),[G,Y]=a.useState(o||0),[Z,V]=a.useState(!1),[X,K]=a.useState(!1),[Q,ee]=a.useState(!1),[te,ne]=a.useState([]),[ie,se]=a.useState(!1),re=a.useRef(null),oe=a.useRef(null),ae=a.useRef(null),le=a.useRef(null),ce=a.useRef(!1),ue=a.useRef(!1),[de,he]=a.useState(null==o);a.useEffect(()=>{if(de)return;const e=()=>{he(!0),window.removeEventListener("wheel",e),window.removeEventListener("touchstart",e)};return window.addEventListener("wheel",e,{passive:!0}),window.addEventListener("touchstart",e,{passive:!0}),()=>{window.removeEventListener("wheel",e),window.removeEventListener("touchstart",e)}},[de]),a.useEffect(()=>{if(ie)return;const e=c.flatMap(e=>e.items||[]).filter(e=>null==e?void 0:e.image).sort((e,t)=>(t.idNumber||0)-(e.idNumber||0))[0];if(!e)return;const t=()=>{try{const t=B(e.image,768);if(!t)return;const n=document.createElement("link");n.rel="preload",n.as="image",n.href=t,n.setAttribute("fetchpriority","high"),n.setAttribute("imagesrcset",`${B(e.image,414)} 414w, ${B(e.image,768)} 768w, ${B(e.image,1024)} 1024w`),n.setAttribute("imagesizes","(max-width: 420px) 414px, (max-width: 800px) 768px, 1024px"),document.head.appendChild(n),se(!0)}catch{}};"requestIdleCallback"in window?requestIdleCallback(t):setTimeout(t,0)},[c,ie]),a.useEffect(()=>{try{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")}catch{}if(null==o)try{window.scrollTo({top:0,behavior:"auto"})}catch{window.scrollTo(0,0)}},[o]);const me=()=>{try{const e={chunks:c,startChunk:d,totalChunks:m,meta:S};sessionStorage.setItem("feedSnapshot",JSON.stringify(e))}catch{}},ge=e=>{g(e.totalChunks),u(t=>{const n=new Map(t.map(e=>[e.chunkIndex,e]));for(const i of e.chunks||[]){let e=Array.isArray(i.items)?i.items:[];P&&null!=L&&(e=e.filter(e=>!e||"number"!=typeof e.idNumber||e.idNumber<=L)),n.set(i.chunkIndex,{...i,items:e})}return Array.from(n.values()).sort((e,t)=>e.chunkIndex-t.chunkIndex)})},pe=e=>{if(!Array.isArray(k)||0===k.length)return!1;const t=Math.ceil(k.length/6);if(g(t),e>=t)return!1;const n=6*e,i=Math.min(n+6,k.length),s=k.slice(n,i);return u(t=>{const n=new Map(t.map(e=>[e.chunkIndex,e]));return n.set(e,{chunkIndex:e,items:s}),Array.from(n.values()).sort((e,t)=>e.chunkIndex-t.chunkIndex)}),!0},fe=async()=>{try{const e=sessionStorage.getItem("sid")||"",t=await fetch("/api/news",{headers:{"x-uid":T,"x-sid":e}});if(!t.ok)throw new Error("list not ok");const n=await t.json(),i=Array.isArray(n.items)?n.items:[];if(0===i.length)return void w(!0);N(i);const s=Math.ceil(i.length/6);g(s);pe(0)}catch{w(!0)}},be=async(e,t=!0)=>{var n;if(!y&&ae.current!==e){ae.current=e,v(!0);try{const t=sessionStorage.getItem("sid")||"",i=new AbortController,s=setTimeout(()=>i.abort(),8e3),r=await fetch(`/api/news/chunks?size=6&start=${e}&count=1`,{headers:{"x-uid":T,"x-sid":t},signal:i.signal,priority:"high"});if(clearTimeout(s),!r.ok)throw new Error("chunks not ok");const o=await r.json();if(0===((null==(n=o.chunks)?void 0:n.length)||0))return fe();ge(o)}catch(i){return console.error("loadChunks error:",i),fe()}finally{v(!1),ae.current=null}}},ye=async()=>{var e;const t=await(async()=>{try{const e=sessionStorage.getItem("sid")||"",t=await fetch("/api/news/meta",{headers:{"x-uid":T,"x-sid":e},cache:"no-store"});if(t.ok){const e=await t.json();return I(e),e}}catch{}return null})(),n=Number(null!=(e=null==t?void 0:t.latestId)?e:null==t?void 0:t.maxId);return Number.isFinite(n)?n:null},ve=()=>{try{const e=sessionStorage.getItem("resumeCardId")||null;if(null==e)return null;const t=Number(e);return Number.isFinite(t)?t:null}catch{return null}},xe=e=>{try{if(null==e)return;sessionStorage.setItem("newCardsNoticeFor",String(e))}catch{}},we=async e=>{if(!ue.current)return;if(ce.current)return;ce.current=!0;const t=null!=e?e:ve(),n=await ye();null!=n&&null!=t&&((e=>{try{if(null==e)return!1;const t=sessionStorage.getItem("newCardsNoticeFor");return null!=t&&Number(t)===Number(e)}catch{return!1}})(t)||n===t||K(!0))},ke=async(e,{remember:t=!1}={})=>{var n;v(!0);try{const i=sessionStorage.getItem("sid")||"",s=new AbortController,r=setTimeout(()=>s.abort(),8e3),o=await fetch(`/api/news/chunk-by-id/${e}?size=6&count=1&cap_newer=true`,{headers:{"x-uid":T,"x-sid":i},signal:s.signal,priority:"high"});if(clearTimeout(r),404===o.status)return!1;if(!o.ok)throw new Error("chunk-by-id not ok");const a=await o.json();if(!(null==(n=null==a?void 0:a.chunks)?void 0:n.length))return!1;if(u(a.chunks),g(a.totalChunks),h(a.start),C(e),z(e),w(!1),t&&null!=e)try{sessionStorage.setItem("lastReloadCardId",String(e))}catch{}const l=(a.chunks||[]).flatMap(e=>e.items||[]);return l.some(t=>t&&Number(t.idNumber)===Number(e))||u(t=>{var n;return[{chunkIndex:t.length?t[0].chunkIndex:a.start||0,items:[{id:String(e),idNumber:Number(e),title:`#${e}`,description:"",sourcesCount:0,image:null,favicons:[],bgColor:null,bgColorDark:null,publishedAt:null},...(null==(n=t[0])?void 0:n.items)||[]]},...t.slice(1)]}),!0}catch(i){return console.error("loadChunkById error:",i),!1}finally{v(!1),ae.current=null}},Ne=()=>{const e=ve();null!=e&&xe(e),K(!1)},je=()=>{u([]),N(null),w(!1),h(0),C(null),sessionStorage.removeItem("resumeCardId"),sessionStorage.removeItem("feedSnapshot");try{sessionStorage.removeItem("newCardsNoticeFor")}catch{}z(null),U(!1),he(!0);try{const e=window.history.state||{};if(e.resumeCardId){const{resumeCardId:t,...n}=e;window.history.replaceState(n,"")}}catch{}try{window.scrollTo({top:0,behavior:"auto"})}catch{try{window.scrollTo(0,0)}catch{}}be(0)};a.useEffect(()=>{(async()=>{var e,t;try{"reload"===(null==(t=((null==(e=performance.getEntriesByType)?void 0:e.call(performance,"navigation"))||[])[0])?void 0:t.type)&&(ue.current=!0)}catch{}const n=(()=>{var e;try{return(null==(e=window.history)?void 0:e.state)||{}}catch{return{}}})(),i=(()=>{const e=null==n?void 0:n.resumeCardId,t=Number(e);return Number.isFinite(t)?t:null})();if(ue.current){const e=ve(),t=null!=e?e:i;if(null!=t){if(await ke(t)){try{sessionStorage.setItem("resumeCardId",String(t))}catch{}return void(await we(t))}}}if(null!=o){if(await ke(o))return void(ue.current&&await we(o))}if(o||null==i)await be(0),ue.current&&await we(null);else{C(e=>null!=e?e:i);try{sessionStorage.setItem("resumeCardId",String(i))}catch{}ue.current&&await we(i)}})()},[o]),a.useEffect(()=>{0!==c.length&&me()},[c,d,m,S]),a.useEffect(()=>{let e=!1;const t=()=>{const e=document.querySelectorAll("[id^='card-']");if(!e.length)return;const t=window.innerHeight/2;let n=null,i=1/0;if(e.forEach(e=>{const s=e.getBoundingClientRect();if(s.bottom<=0||s.top>=window.innerHeight)return;const r=s.top+s.height/2,o=Math.abs(r-t);if(o<i){i=o;const t=e.id||"",s=Number(t.replace("card-",""));Number.isFinite(s)&&(n=s)}}),null!=n&&A.current!==n){A.current=n,Y(n),sessionStorage.setItem("resumeCardId",String(n));try{const e=window.history.state||{};e.resumeCardId!==n&&window.history.replaceState({...e,resumeCardId:n},"")}catch{}}},n=()=>{e||(e=!0,requestAnimationFrame(()=>{t(),e=!1}))};return window.addEventListener("scroll",n,{passive:!0}),t(),()=>window.removeEventListener("scroll",n)},[c]),a.useEffect(()=>{let e=!1;const t=()=>{if(Q)return;if(null!=j)return;if(!de)return;const e=c.flatMap(e=>e.items||[]).filter(e=>e&&null!=e.idNumber);if(e.length<4)return;e.sort((e,t)=>(t.idNumber||0)-(e.idNumber||0));if((window.scrollY||0)<=200&&!y){const e=(c.length?c[0].chunkIndex:d)-1;e>=0&&(k&&k.length?pe(e):le.current!==e&&(async e=>{var t;if(y)return;if(e<0)return;if(le.current===e)return;le.current=e;const n=window.scrollY,i=E.current,s=(null==i?void 0:i.scrollHeight)||0;v(!0);try{const r=sessionStorage.getItem("sid")||"",o=await fetch(`/api/news/chunks?size=6&start=${e}&count=1`,{headers:{"x-uid":T,"x-sid":r}});if(!o.ok)throw new Error("previous chunk not ok");const a=await o.json();if(0===((null==(t=a.chunks)?void 0:t.length)||0))return;ge(a),requestAnimationFrame(()=>{if(i){const e=i.scrollHeight-s;e>0&&window.scrollTo(0,n+e)}})}catch(r){console.error("loadPreviousChunk error:",r)}finally{v(!1),le.current=null}})(e))}const t=e[e.length>=6?e.length-6:0];if(!(null==t?void 0:t.idNumber))return;const n=document.getElementById(`card-${t.idNumber}`);if(!n)return;const i="undefined"!=typeof window?window.innerHeight:0;if(0===i)return;const s=n.getBoundingClientRect();if(s.top<=i&&s.bottom>=0&&!y){const e=(c.length?c[c.length-1].chunkIndex:d)+1;k&&k.length?pe(e):(null==m||e<m)&&(null==m||e<m)&&be(e)}},n=()=>{e||(e=!0,requestAnimationFrame(()=>{t(),e=!1}))};return t(),window.addEventListener("scroll",n,{passive:!0}),()=>window.removeEventListener("scroll",n)},[c,m,k,y,Q,j,de]),a.useEffect(()=>{if(Q)return;if(null!=j)return;if(!de)return;const e=re.current;if(!e)return;const t=new IntersectionObserver(e=>{for(const t of e){if(!t.isIntersecting)continue;if(y)continue;const e=(c.length?c[c.length-1].chunkIndex:d)+1;k&&k.length?pe(e):(null==m||e<m)&&ae.current!==e&&be(e)}},{root:null,rootMargin:"600px 0px 600px 0px",threshold:0});return t.observe(e),()=>t.disconnect()},[c,m,k,y,Q,j,de]),a.useEffect(()=>{if(0===c.length)return;const e=c[c.length-1].chunkIndex;if(setTimeout(()=>{fetch("/api/analytics/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:T,event:"chunk_view",chunkIndex:e,ts:Date.now()})}).catch(()=>{})},100),null!=j){const e=document.getElementById(`card-${j}`);if(e){e.scrollIntoView({behavior:"instant",block:"start"}),$(j),setTimeout(()=>$(null),1e3),C(null),U(!1);const t=()=>{he(!0),window.removeEventListener("wheel",t),window.removeEventListener("touchstart",t)};window.addEventListener("wheel",t,{passive:!0}),window.addEventListener("touchstart",t,{passive:!0})}}},[c,j]);const Ce=(e,n)=>{me(),sessionStorage.setItem("resumeCardId",String(e)),t(`/article/${e}`,{state:{article:n}})};a.useEffect(()=>{if(!X)return;const e=ve();null!=e&&xe(e)},[X]);const Se=a.useMemo(()=>{const e=c.flatMap(e=>e.items||[]).filter(e=>e&&null!=e.idNumber);return e.sort((e,t)=>(t.idNumber||0)-(e.idNumber||0)),e},[c]),Ie=te.map(e=>{if(e&&(null!=e.description||null!=e.image||Array.isArray(e.favicons)&&e.favicons.length))return e;return Se.find(t=>t.idNumber===e.idNumber)||{id:e.idNumber,idNumber:e.idNumber,title:e.title||`#${e.idNumber}`,description:"",sourcesCount:0,image:null,favicons:[],bgColor:null,bgColorDark:null,publishedAt:null}}).sort((e,t)=>(t.idNumber||0)-(e.idNumber||0)),Ee=Se.length?{title:Se[0].title,image:Array.isArray(Se[0].images)&&Se[0].images.length?Se[0].images[0]:Se[0].image,description:Se[0].description||""}:null;return e.jsxs("div",{className:"discover-mobile",children:[X&&!Q&&e.jsxs("div",{className:"new-pill",role:"status","aria-live":"polite",children:[e.jsxs("div",{className:"pill-text",children:[e.jsx("strong",{children:"New cards"})," have been added since you last visited."]}),e.jsxs("div",{className:"pill-actions",children:[e.jsx("button",{className:"pill-btn",onClick:()=>{Ne(),je()},children:"Refresh"}),e.jsx("button",{className:"pill-btn ghost",onClick:Ne,children:"Dismiss"})]})]}),e.jsx(R,{title:Q?"Favorites":"Discover",onResetFeed:je,onOpenSearch:()=>_(!0),onToggleSections:()=>W(e=>!e),onOpenFavorites:async()=>{if(Q)ee(!1);else try{const e=sessionStorage.getItem("sid")||"",t=await fetch("/api/user/saved",{headers:{"x-uid":T,"x-sid":e}});if(!t.ok)throw new Error("saved not ok");const n=await t.json(),i=Array.isArray(n.items)?n.items:[];ne(i),ee(!0),window.scrollTo({top:0,behavior:"instant"})}catch(e){console.error("favorites load error",e)}},isFavorites:Q,topItem:Ee}),e.jsx(D,{}),e.jsxs("div",{className:"feed-list",ref:E,children:[e.jsx("div",{ref:oe,style:{height:"1px",visibility:"hidden"}}),y&&0===Se.length&&!Q&&e.jsx(e.Fragment,{children:Array.from({length:6}).map((t,n)=>e.jsx(q,{},`sk-${n}`))}),y&&Se.length>0&&!Q&&e.jsx("div",{className:"text-muted",children:"Loading..."}),x&&!y&&0===c.length&&!Q&&e.jsx("div",{className:"text-muted",children:"No news available."}),(Q?Ie:Se).map((t,n)=>{if(!t.idNumber)return null;const i=!Q&&(n+1)%7==0;return e.jsxs(r.Fragment,{children:[e.jsx("div",{id:`card-${t.idNumber}`,onClick:e=>((e,t,n)=>{const i=e.target.closest("button.icon-btn");if(i){const e=(i.getAttribute("aria-label")||"").toLowerCase();if("like"===e||"more"===e||"share"===e)return}e.target.closest("article.feed-card.card")&&Ce(t,n)})(e,t.idNumber,{id:t.id,idNumber:t.idNumber,title:t.title,description:J?"":t.description,sourcesCount:t.sourcesCount,image:Array.isArray(t.images)&&t.images.length?t.images[0]:t.image,favicons:t.favicons,bgColor:t.bgColor,bgColorDark:t.bgColorDark,publishedAt:t.publishedAt}),role:"button",tabIndex:0,children:e.jsx(O,{article:{id:t.id,idNumber:t.idNumber,title:t.title,description:J?"":t.description,sources:t.sourcesCount,image:Array.isArray(t.images)&&t.images.length?t.images[0]:t.image,favicons:t.favicons,bgColor:t.bgColor,bgColorDark:t.bgColorDark,publishedAt:t.publishedAt},globalIndex:n,highlighted:M===t.idNumber,onOpen:()=>Ce(t.idNumber,{id:t.id,idNumber:t.idNumber,title:t.title,description:J?"":t.description,sourcesCount:t.sourcesCount,image:Array.isArray(t.images)&&t.images.length?t.images[0]:t.image,favicons:t.favicons,bgColor:t.bgColor,bgColorDark:t.bgColorDark,publishedAt:t.publishedAt}),hideMeta:J})}),i&&e.jsx("div",{className:"feed-separator","aria-hidden":"true"})]},`frag-${t.idNumber||t.id||t.title}`)}),e.jsx("div",{ref:re})]}),H&&e.jsx(F,{items:(Q?Ie:Se).map(e=>({id:e.id,idNumber:e.idNumber,title:e.title,description:e.description,image:Array.isArray(e.images)&&e.images.length?e.images[0]:e.image,bgColor:e.bgColor,bgColorDark:e.bgColorDark,favicons:e.favicons,sourcesCount:e.sourcesCount})),onClose:()=>_(!1),onSubmit:()=>{},onSelect:e=>{_(!1);const t=(Q?Ie:Se).find(t=>t.idNumber===e.idNumber||(t.id||t.title)===(e.id||e.title));t&&t.idNumber&&Ce(t.idNumber,{id:t.id,idNumber:t.idNumber,title:t.title,description:t.description,sourcesCount:t.sourcesCount,image:t.image,favicons:t.favicons,bgColor:t.bgColor,bgColorDark:t.bgColorDark})}})]})}export{U as default};
